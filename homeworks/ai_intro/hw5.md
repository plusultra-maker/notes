# 《人工智能引论》课后练习-5
> 2000011483 喻勃洋
## 题目1
### 1）
透视投影，投影的对应射线经过相机位置 $(-1,0,0)$ 则有：
- 对于点 $(0,1,0)$ ，其投影线与z轴夹角45°，与球无交点，故成像为无穷远处的背景，由于背景颜色为0，故该像素点颜色为0。
- 对于点 $(0,0.25,0)$ ，其投影线与z轴夹角约14.04°，与球的第一个交点坐标为 $(0,1.248,3.334)$，故成像为球的上该点的颜色。由于球的本底颜色为0.2，光源带来的颜色为 $0.8*cos(\theta)$，其中$\theta$为光线入射与法线夹角。几何计算得 $$\theta=tan^{-1}(\frac{3.334-(-1)}{5-1.248})-2*14.04°=21.04°$$ 故该像素点颜色为 $0.2+0.8*cos(21.04°)=0.947$。
- 对于点 $(0,-0.25,0)$，由对称性，其与球的第一个交点坐标为， $(0,-1.248,3.334)$，故成像为球的上该点的颜色。而由此点的半径向量即法向量 $\vec{r}=(0,-1.248,0.666) $ , 从此点到光源的光线向量 $\vec{l}=(0,5+1.248,3.334+1)$， 两者点乘结果为 $-4.91<0$ ，故该点为光源阴影，光源不提供光照，颜色等于本底颜色为0.2。

### 2）
正交投影，则所有投影线平行于z轴，有：
- 对于点 $(0,1,0)$ ，其投影线与球交于 $(0,1,3)$，故成像为球的上该点的颜色。由于球的本底颜色为0.2，光源带来的颜色为 $0.8*cos(\theta)$，其中$\theta$为光线入射与法线夹角。几何计算得 $$\theta=tan^{-1}(\frac{3-(-1)}{5-1})-45°=0°$$ 故该像素点颜色为 $0.2+0.8=1$。
- 对于点 $(0,0.25,0)$ ，其投影线与球交于 $(0,0.25,2.608)$，故成像为球的上该点的颜色。同上理，计算入射角得 $$\theta=tan^{-1}(\frac{2.608-(-1)}{5-0.25})-cos^{-1}(\frac{0.25}{\sqrt{2}})=-42.60°$$ 故该像素点颜色为 $0.2+0.8*cos(-42.60°)=0.789$。(角度为负说明入射光在法线夹角正方向的另一侧，但不影响其余弦值的正确性)
- 对于点 $(0,-0.25,0)$ ，其投影线与球交于 $(0,-0.25,2.608)$，故成像为球的上该点的颜色。同上理，计算入射角得 $$\theta=180°-tan^{-1}(\frac{2.608-(-1)}{5+0.25})-cos^{-1}(\frac{0.25}{\sqrt{2}})=65.68°$$ 故该像素点颜色为 $0.2+0.8*cos(65.68°)=0.529$。

## 题目2
### 1）
用$relu(x)$表示对x从0-截取,使输出不小于0，以表示弹簧在放松后不再有弹力
对于x1:
$$ m \mathrm{d}v_1 =[k( relu(x_2-x_1-l_0))+k( relu(x_3-x_1-l_0))]\mathrm{d}t$$ $$ \mathrm{d}x_1 = v_1\mathrm{d}t $$
对于x2:
$$ m \mathrm{d}v_2 =[-k( relu(x_2-x_1-l_0))+k( relu(x_3-x_2-l_0))]\mathrm{d}t$$ $$ \mathrm{d}x_2 = v_2\mathrm{d}t $$
对于x3:
$$ m \mathrm{d}v_3 =[-k( relu(x_3-x_1-l_0))-k( relu(x_3-x_2-l_0))]\mathrm{d}t$$ $$ \mathrm{d}x_3 = v_3\mathrm{d}t $$
需要注意的是以上式子尽在当前t=0即此后三者的位置关系不变的时间内成立，否则需要改写弹簧长度内减法的顺序和某些受力的正负号。
### 2）
半隐式欧拉积分，即用用当前的位置计算速度变换，用下一时刻的速度计算位置的变换，即：
$$ v_{n+1}=v_n+\frac{F_n}{m}\Delta t$$ $$ x_{n+1}=x_n+v_{n+1}\Delta t$$
结合上述动力学方程：
对于x1:
$$ v_{1,1}=v_{1,0}+\frac{[k( relu(x_{2,0}-x_{1,0}-l_0))+k( relu(x_{3,0}-x_{1,0}-l_0))]}{m}*h$$ 代入数据得 $$ v_{1,1}=3$$ 故 $$ x_{1,1}=x_{1,0}+v_{1,1}h= 2$$
对于x2:
$$ v_{2,1}=v_{2,0}+\frac{[-k( relu(x_{2,0}-x_{1,0}-l_0))+k( relu(x_{3,0}-x_{2,0}-l_0))]}{m}*h$$ 代入数据得 $$ v_{2,1}=3$$ 故 $$ x_{2,1}=x_{2,0}+v_{2,1}h= 3$$
对于x3:
$$ v_{3,1}=v_{3,0}+\frac{[-k( relu(x_{3,0}-x_{1,0}-l_0))-k( relu(x_{3,0}-x_{2,0}-l_0))]}{m}*h$$ 代入数据得 $$ v_{3,1}=-6$$ 故 $$ x_{3,1}=x_{3,0}+v_{3,1}h= -3$$
### 3）
隐式欧拉积分：由于我们不知道t=1时刻，x1,x2,x3的实际位置，所以就沿用t=0时刻的位置带来的受力方向，再在计算完成后验证合理性
注意各个物体的方程需要联立:（代入参数值）
$$
\begin{cases}
v_{1,1}=v_{1,0}+[ relu(x_{2,1}-x_{1,1}-1)+ relu(x_{3,1}-x_{1,1}-1)] \\
v_{2,1}=v_{2,0}+[- relu(x_{2,1}-x_{1,1}-1)+ relu(x_{3,1}-x_{2,1}-1)] \\
v_{3,1}=v_{3,0}+[- relu(x_{3,1}-x_{1,1}-1)- relu(x_{3,1}-x_{2,1}-1)] \\
x_{1,1}=x_{1,0}+v_{1,1} \\
x_{2,1}=x_{2,0}+v_{2,1} \\
x_{3,1}=x_{3,0}+v_{3,1} \\
\end{cases}
$$
解得：
$$
\begin{cases}
v_{1,1}=\frac{3}{4} \\
x_{1,1}=-\frac{1}{4} \\
v_{2,1}=\frac{7}{8} \\
x_{2,1}=\frac{7}{8} \\
v_{3,1}=-\frac{13}{8} \\
x_{3,1}=\frac{11}{8} \\
\end{cases}
$$
也就是说x2，x3之间的距离小于1，不再有弹力。
且验证，三者的位置关系仍然不变，即 $x_1< x_2 < x_3$，上述的弹力方向仍成立。
因此此解是一个合理的解。
Ps. 在隐式欧拉的计算中可以看出，当我们使用未知的位置来计算速度时，由于我们的方程中很可能出现relu这样的分段的非线性函数，同时方程可能也需要写成非线性的分类形式，因此解这个方程时，很有可能出现对于分类和分段得到的解不符合其分类和分段的要求的情况，需要我们对解进行排除；如果恰好所有情况的解都不符合其情况的设定，那么方程没有对应的合理的解，隐式欧拉的计算就会失败，我们没法通过此逻辑预测下一时刻的位置和速度。这与步长较长也有关系。

## 题目3
### 1）
纳什均衡点(A的策略，B的策略)有：
(v,x) 和 (u,z)
### 2）
这是一个双人零和博弈。
可以验证四个点都不是纯策略纳什均衡点，不存在纯策略纳什均衡。
根据minimax theorem，假定A以p的概率选择v，以1-p的概率选择u，B以q的概率选择x，以1-q的概率选择y，那么对于A来说，他的期望收益为：
$$ 13pq-8p-6q+3$$
那么

$$
V_{maximin} = max_{p}min_{q}13pq-8p-6q+3 $$
$$
\begin{align}
V_{maximin} &= max_{p} \notag
\begin{cases}
5p-3 & p<\frac{6}{13}  \\
-\frac{9}{13} & p=\frac{6}{13} \\
-8p+3 & p>\frac{6}{13} \\
\end{cases} 
\\ &= -\frac{9}{13} \notag
\end{align}
$$
同理计算
$$
V_{minimax} = min_{q}max_{p}13pq-8p-6q+3 $$
$$
\begin{align}
V_{minimax} &= min_{q} \notag
\begin{cases}
-6q+3 & q<\frac{8}{13}  \\
-\frac{9}{13} & q=\frac{8}{13} \\
7q-5 & q>\frac{8}{13} \\
\end{cases}
\\ &= -\frac{9}{13} \notag
\end{align}
$$
因此，满足 $$V_{maximin} = V_{minimax}$$
说明构成纳什均衡，此时
$$
p=\frac{6}{13},q=\frac{8}{13}
$$ 下的 $A:[p,1-p] ,B:[q,1-q]$ 为纳什均衡策略。
A的期望收益为 $$ -\frac{9}{13}$$