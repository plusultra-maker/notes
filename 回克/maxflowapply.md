### 最大流算法的应用
> 喻勃洋 2023.4.28 算分小班
- 带需求的流通
  - 将最大流问题扩展为多个起点(S)和终点(T)，每个点都固定的需求$d_v$（需求为负则构成供给）
    - 问：是否存在可行流通
  - 问题的特性：
    - 流不凭空出现，不凭空消失：总需求的代数和为0：$$\sum_{v\in T}d_v=\sum_{v\in S}-d_v$$
    - 因此可以可以想象为流从一个地方s\*发给S，再从T汇集到一个地方t\*，且每条对应线路的上限为$|d_v|$，只要供满即满足需求
  - 解决：
    - 如上所述，添加超节点s\*,t\*,并按要求连接所有收发点，构成G'的最大流问题
    - 可以有引理：G中存在一个带需求${d_v}$的可行流通，当且仅当G'的最大流为D
    - ![图1](./图1.png)
- 运输问题 (Hitchcock问题)
  - 将最小费用流问题扩展为多个起点(S)和终点(T)，每个点都固定的供给$a_i$或需求$b_i$，如何安排使得总运费最小
  - 与“带需求的流通”问题高度相似，其关系就如同传统的最大流与最小费用流问题的关系
  - 解决：
    - 添加超节点s\*,t\*,并按每条对应补充线路的容量上限为$a_i或b_i$，费用为0
    - 记$v_0=\sum_i a_i=\sum_j b_j$，则所有补充线路全满等价于总流量$v_0$，构成G'的满足流量$v_0$问题
    - ![图2](./图2.png)
- 二部图的最大匹配
  - 对于给定的二部图G=<A,B,E>，M是其边集的子集，如果M中任意两条边都不相邻，则M为G的一个匹配
    - 通俗的看，即M的选择表示了A B之间的一个单射，每个点只能匹配一个点
    - 问：尽可能多的匹配
  - 增广交错路径
    - 边：匹配即是否属于M；点：饱和即是否已被匹配
    - G 中由匹配边和非匹配边交替构成的路径称为交错路径
    - 起点和终点都是非饱和点的交错路径称为增广交错路径
  - 增广交错路径的特性
    - 起终点异侧，共2m个点：__1,2,...,2m-1,2m__
    - 起终边都是非匹配边,故匹配关系为：__1,(2,3),(4,5),...,(2m-2,2m-1),2m__，共$m-1$对
    - 因此必然可以将此路径上的边和匹配关系改为：__(1,2),(3,4),...,(2m-1,2m)__，共$m$对，使得匹配数增加
    - ![图3](./图3.png)
    - >引理12设 M 是二部图 G 的一个匹配, P是一条关于M 的增广交错路径, 则$M' = M \oplus E(P)$是一个匹配 且 |M' | = |M| + 1. 
    - >定理8 二部图的匹配是最大匹配当且仅当不存在关于它的增广交错路径
  - 匈牙利算法
    - 从一个初始匹配 M 开始, 每次找一条增广交错路径 P, 令 $M' \leftarrow M \oplus E(P)$, 直到不存在增广交错路径为止. 
    - 复杂度：每次搜索$O(|E|)$,总迭代次数即最大匹配数
  - 与最大流的关系
    - 类比“带需求的流通”，同属于多起点多终点问题，可以添加超起点和超终点，并将所有边的容量设为1（只能通过0或1），_A与B间的边全部为A到B的单向边_
    - 则最大匹配即最大流量
    - 可以看出，一条增广交错路径即一个s-t增广链
    - 因此匈牙利算法即FF算法
- 赋权二部图的匹配
  - 指派问题：完全二部图，给定匹配的权值，求权和最小的匹配
  - 期中考试题目4
  - Kuhn-Munkres Algorithm也即匈牙利算法
    - [KM算法 oi-wiki](https://oi-wiki.org/graph/graph-matching/bigraph-weight-match/#hungarian-algorithmkuhn-munkres-algorithm)
  - 本质上，这种算法与教科书上基于原始-对偶的线性规划算法是一样的
  - 转化为费用流模型
- 图像分割
  - 目标：将一个问题的前景背景分离
  - ![图4](./图4.png)
  - 最优标记
  - 这个问题从形式上看就很像最小割
    - 想把一部分像素分给前景，一部分像素分给后景，尽量符合事实并且尽量少的分割
    - 也就是在像素间做一个最小割，切断尽可能小的可能性，使得每个元素待在更属于自己的景区里
    - ![图5](./图5.png)
  - 数学语言：
    - 最大化：$q(A,B)=\sum_{i\in A}a_i+\sum_{j\in B}b_j- \sum_{i,j不同区}p_{ij}$
    - 等价于最小化:$q'(A,B)=\sum_{i\in B}a_i+\sum_{j\in A}b_j+ \sum_{i,j不同区}p_{ij}$
    - 等价于一个最小割问题